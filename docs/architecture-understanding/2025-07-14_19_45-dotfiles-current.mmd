graph TB
    subgraph "User Environment"
        User[ðŸ‘¤ User]
        Terminal[ðŸ–¥ï¸ Terminal/iTerm2]
        Shell[ðŸš Zsh + Starship]
        IDE[ðŸŽ¯ VS Code/JetBrains]
    end

    subgraph "Package Management"
        NixDarwin[ðŸ“¦ Nix Darwin - PRIMARY]
        HomeManager[ðŸ  Home Manager - ENABLED]
        Homebrew[ðŸº Homebrew - GUI Apps Only]
        GoTools[ðŸ”§ Go Development Tools]
    end

    subgraph "Configuration Management"
        FlakeNix[âš™ï¸ flake.nix]
        EnvironmentNix[ðŸŒ environment.nix]
        HomeNix[ðŸ  home.nix]
        ProgramsNix[ðŸ“‹ programs.nix]
        CoreNix[âš™ï¸ core.nix]
    end

    subgraph "Development Tools"
        Git[ðŸ“Š Git + git-town]
        GoLang[ðŸ”· Go + 10 Tools]
        NodeJS[ðŸŸ¢ Node.js + Bun]
        CloudTools[â˜ï¸ kubectl/AWS/GCP]
        SecurityTools[ðŸ”’ gitleaks/Security]
    end

    subgraph "Shell Environment"
        ZshConfig[âš™ï¸ .zshrc - Optimized]
        StarshipConfig[â­ starship.toml]
        CompletionCache[ðŸ“ Completion Cache]
        PathManagement[ðŸ›£ï¸ PATH - Consolidated]
    end

    subgraph "Automation & Quality"
        Justfile[âš¡ Justfile - 40+ Commands]
        PreCommitHooks[âœ… Pre-commit - Working]
        TreeFmt[ðŸŽ¨ treefmt - Universal Formatter]
        PerformanceMonitoring[ðŸ“Š Performance Scripts]
    end

    subgraph "Documentation & Knowledge"
        Docs[ðŸ“š Comprehensive Docs]
        TroubleshootingGuide[ðŸ†˜ Troubleshooting]
        GoToolsGuide[ðŸ”§ Go Tools Guide]
        ArchitectureDocs[ðŸ—ï¸ Architecture Analysis]
    end

    %% User workflow
    User --> Terminal
    Terminal --> Shell
    User --> IDE
    User --> Justfile

    %% Package management flow
    NixDarwin --> FlakeNix
    FlakeNix --> EnvironmentNix
    FlakeNix --> HomeManager
    HomeManager --> HomeNix
    FlakeNix --> ProgramsNix
    FlakeNix --> CoreNix
    
    %% Homebrew minimal integration
    Homebrew -.-> NixDarwin

    %% Shell configuration
    HomeManager --> ZshConfig
    HomeManager --> StarshipConfig
    HomeManager --> CompletionCache
    EnvironmentNix --> PathManagement
    PathManagement --> Shell

    %% Development environment
    EnvironmentNix --> GoLang
    EnvironmentNix --> NodeJS
    EnvironmentNix --> CloudTools
    EnvironmentNix --> SecurityTools
    GoLang --> GoTools

    %% Version control integration
    Shell --> Git
    Git --> PreCommitHooks
    PreCommitHooks --> TreeFmt

    %% Automation integration
    Justfile --> NixDarwin
    Justfile --> Git
    Justfile --> GoTools
    Justfile --> PerformanceMonitoring

    %% Documentation integration
    Docs --> TroubleshootingGuide
    Docs --> GoToolsGuide
    Docs --> ArchitectureDocs

    classDef primary fill:#e1f5fe,stroke:#01579b,stroke-width:3px
    classDef working fill:#e8f5e8,stroke:#2e7d32,stroke-width:2px
    classDef optimized fill:#fff3e0,stroke:#ef6c00,stroke-width:2px
    classDef documentation fill:#fce4ec,stroke:#c2185b,stroke-width:2px

    class NixDarwin,HomeManager,FlakeNix primary
    class Git,GoLang,Shell,Justfile working
    class ZshConfig,PathManagement,CompletionCache optimized
    class Docs,TroubleshootingGuide,GoToolsGuide documentation